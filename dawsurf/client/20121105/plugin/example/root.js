(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","curl","css!./root"],function(b,c){var d;return d=function(){function d(){this._reposition=a(this._reposition,this),this._kill_key_handler=a(this._kill_key_handler,this),this._init_key_handler=a(this._init_key_handler,this),this._create_param=a(this._create_param,this),this.revalue_param=a(this.revalue_param,this),this.rename_param=a(this.rename_param,this),this.rename_folder=a(this.rename_folder,this),this.remove_folder=a(this.remove_folder,this),this.move_folder=a(this.move_folder,this),this.insert_folder=a(this.insert_folder,this),this.add_param=a(this.add_param,this),this.add_folder=a(this.add_folder,this),this.kill=a(this.kill,this),this.init=a(this.init,this)}return d.prototype.init=function(){var a=this;return window.jQuery=window.$=b,c(["js!plugin/lib.3p/jQuery-ZenCoding"]).then(function(){return b.noConflict(!0),a._$root=b(a._div_root).addClass("root").attr({id:"0"}),a._init_key_handler(),a.on_init()})},d.prototype.kill=function(){return this._kill_key_handler(),this._$root.removeAttr("id").removeClass("root").empty()},d.prototype.on_init=function(){},d.prototype.on_exit=function(){},d.prototype.add_folder=function(a){return this._get_target(a).append(this._create_folder(a))},d.prototype.add_param=function(a){return this._get_target(a).append(this._create_param(a).html(this._get_param_html(a)))},d.prototype.insert_folder=function(a){return this._reposition(a,this._create_folder(a))},d.prototype.move_folder=function(a){return this._reposition(a,this._get_el(a))},d.prototype.remove_folder=function(a){return this._get_el(a).remove()},d.prototype.rename_folder=function(a){return this._get_el(a).find(">.name").html(a.name)},d.prototype.rename_param=function(a){return this._get_el(a).html(this._get_param_html(a))},d.prototype.revalue_param=function(a){return this._get_el(a).html(this._get_param_html(a))},d.prototype._create_folder=function(a){return b(b.zen("#"+a.uid+"."+a.category+">{"+a.category+" = }+span.name{"+a.name+"}"))},d.prototype._create_param=function(a){return b(b.zen("#"+a.uid+".param"))},d.prototype._get_el=function(a){return b("#"+assert(function(){return a.uid}))},d.prototype._get_target=function(a){return b("#"+a.target_uid)},d.prototype._get_param_html=function(a){return b.zen("p{param:"+a.name+" = "+a.value_text+"}")},d.prototype._init_key_handler=function(){var a=this;return b(document).on("keydown",function(c){if(c.which===b.ui.keyCode.ESCAPE)return a.on_exit()})},d.prototype._kill_key_handler=function(){return b(document).off("keydown")},d.prototype._reposition=function(a,b){var c;return c=this._get_target(a),a.target_placement==="Before"?b.insertBefore(c):b.insertAfter(c)},d}(),new d})}).call(this);