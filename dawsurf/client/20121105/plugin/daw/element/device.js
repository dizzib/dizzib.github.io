(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","underscore","css!./device"],function(b,c){var d;return new(d=function(){function c(){this._reposition=a(this._reposition,this),this._get_device_body=a(this._get_device_body,this),this._get_device=a(this._get_device,this),this._create=a(this._create,this),this.rename=a(this.rename,this),this.remove=a(this.remove,this),this.ready=a(this.ready,this),this.move=a(this.move,this),this.insert=a(this.insert,this),this.clear=a(this.clear,this),this.add_box=a(this.add_box,this),this.add=a(this.add,this),this.init=a(this.init,this)}return c.prototype._INIT_MSG=" loading...",c.prototype.init=function(a){return a.$desk.on("safe-tap",".device h2",{on_toggle:this.on_toggle},function(a){var c;return(c=b(this)).indicate().parents(".device").toggleClass("hidden"),a.data.on_toggle({$target:c}),a.handled=!0})},c.prototype.on_add=function(){},c.prototype.on_create=function(){},c.prototype.on_remove=function(){},c.prototype.on_toggle=function(){},c.prototype.add=function(a){var b;return this.on_create(a,b=this._create(a)),this.on_add({$device:b})},c.prototype.add_box=function(a){return this._get_device_body(a).append(a.$box)},c.prototype.clear=function(a){return this._get_device_body(a).empty()},c.prototype.get_by_uid=function(a){return b("#"+a+".device")},c.prototype.insert=function(a){var b;return this._reposition(a,b=this._create(a)),this.on_add({$device:b})},c.prototype.move=function(a){return this._reposition(a,this._get_device(a))},c.prototype.ready=function(a){var b;return b=a.find("h2"),b.text(b.text().replace(this._INIT_MSG,""))},c.prototype.remove=function(a){var b,c=this;return(b=this._get_device(a)).fadeOut(function(){return c.on_remove({$device:b}),b.remove()})},c.prototype.rename=function(a){return this._get_device(a).find("h2").html(a.name.fracture())},c.prototype._create=function(a){return b(b.zen("#"+a.uid+".device>((.head>h2{"+a.name.fracture()+this._INIT_MSG+"})+(.body))"))},c.prototype._get_device=function(a){return this.get_by_uid(a.uid)},c.prototype._get_device_body=function(a){return this._get_device(a).find(".body")},c.prototype._get_target=function(a){return b("#"+assert(function(){return a.target_uid})+".device")},c.prototype._reposition=function(a,b){var c;return c=this._get_target(a),a.target_placement==="Before"?b.insertBefore(c):b.insertAfter(c)},c}())})}).call(this);