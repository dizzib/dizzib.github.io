(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","underscore","./cell.arranger/mason","./cell.arranger/helper","plugin/constants","lib/guardian"],function(b,c,d,e,f){var g;return g=function(){function e(){this._arrange_wild=a(this._arrange_wild,this),this.arrange_track=a(this.arrange_track,this)}return e.prototype._GROUP_ANIMATE_DURATION_MS=500,e.prototype.arrange_track=function(a){return this._arrange_wild(a.$track,a.x_size)},e.prototype._arrange_wild=function(a,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;t=a.find(".wild > .cells:not(:empty)"),w=[];for(o=0,r=t.length;o<r;o++){i=t[o],h=(f=b(i)).find(".group"),u=[[],[],[]],k=u[0],l=u[1],m=u[2];for(p=0,s=h.length;p<s;p++)j=h[p],l.push((g=b(j)).attr("data-group-name")),k.push(g.hasClass("collapsed")?g:g.nextUntil(".group").andSelf()),m.push(c.last(k).length);n=d.build(function(){x=[];for(var a=1,b=l.length;1<=b?a<=b:a>=b;1<=b?a++:a--)x.push(a);return x}.apply(this),m,e),w.push(this._apply_matrix(f,k,n))}return w},e.prototype._apply_matrix=function(a,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r;j=function(){var a,b,d;d=[];for(a=0,b=c.length;a<b;a++)h=c[a],d.push(0);return d}();for(k=0,p=d.length;k<p;k++){n=d[k];for(l=0,q=n.length;l<q;l++){g=n[l];if((i=Math.abs(d[k][l])-1)===-1)continue;e=b(c[i][j[i]++]),r=[l*f.CELL_SIZE,k*f.CELL_SIZE],m=r[0],o=r[1],j[i]===1?e.animate({left:m,top:o},this._GROUP_ANIMATE_DURATION_MS):e.css({left:m,top:o}),l<n.length-1&&i!==Math.abs(d[k][l+1])-1?e.addClass("sep-r"):e.removeClass("sep-r"),k<d.length-1&&i!==Math.abs(d[k+1][l])-1?e.addClass("sep-b"):e.removeClass("sep-b")}}return a.height(k*f.CELL_SIZE)},e}(),new g})}).call(this);