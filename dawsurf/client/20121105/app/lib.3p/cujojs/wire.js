/** @license MIT License (c) copyright B Cavalier & J Hann *//**
 * wire
 * Javascript IOC Container
 *
 * wire is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 0.8.2
 */(function(a,b){b(["require","when","./base"],function(c,d,e){function u(a){return function(b){a.reject(b)}}function v(a){var b=n();return b.reject(a),b.promise}function x(a){return k||(k=z(j)),d(k,function(b){return b.wire(a)})}function y(a,b,c,d){var e=c.resolve?c:{resolve:c,reject:function(a){throw a}};o(x(a.split(",")),e)}function z(a,b){function c(a){return d(B(a,b),function(a){return a})}return d(A(q(a)?a:[a]),c)}function A(a){return d.reduce(a,function(a,b){return E(b)?d(w(b),function(b){return C(a,b)}):C(a,b)},{})}function B(a,b,c){function S(a){i=T(l(a.objects||{})),k=l(a.resolvers||{}),m=l(a.factories||{}),x=l(a.facets||{}),k.wire=ub,m.module=pb,m.create=qb,m.wire=rb,y=H(a.listeners),A=H(a.proxies),h=[],C=[],I={},K=n(),M=n(),P=n(),g={name:c,objects:i,destroyed:P},f=l(g),f.resolvers=k,f.factories=m,f.facets=x,f.listeners=y,f.proxies=A,f.resolveRef=tb,f.destroy=vb,f.path=ab(c,a.path),a.destroyed&&d(a.destroyed,vb)}function T(a){return J=a.wire=_,J.destroy=a.destroy=$,J.resolve=a.resolve=Z,l(a)}function U(){j=function(a,b,c){var e=n();return d(cb(a,ab(b,c)),function(a){e.resolve(a)},e.reject),e.promise},j.resolveRef=Z}function V(a,b){var c=[];for(var d in a)a.hasOwnProperty(d)&&c.push(i[d]=n());return o(p(c),b,i)}function W(a){for(var b in a)bb(b,a[b],i[b])}function X(){p(C,function(a){K.resolve(a),I=C=null})}function Y(){var a,c,d,e;P.resolve(),c=[];for(e=0;a=h[e++];)d=n(),c.push(d),nb(d,"destroy",a);return p(c,function(){function a(a){for(var b in a)delete a[b]}a(i),a(f);var c,d;for(d=0;c=h[d++];)c.destroy();i=f=h=A=b=k=m=x=J=t,y=t}),P}function Z(a){return d(tb(a))}function $(){return vb()}function _(a){return z(a,g)}function ab(a,b){var c=b||f.path;return c&&a?c+"."+a:a}function bb(a,b,c){var e=cb(b,a);return d(e,function(b){i[a]=O(b),c.resolve(b)},u(c))}function cb(a,b){var c;return D(a)?c=sb(a,b):q(a)?c=hb(a,b):F(a)?c=ib(a,b):c=a,c}function db(a,b){var c,e;if(E(a)){var f=I[a];f||(C.push(a),f=I[a]={id:a,deferred:n()},I[a]=f,e=d(w(a),function(a){eb(a,b),o(K,f.deferred,a)}),C.push(e)),c=f.deferred}else c=a,eb(c);return c}function eb(a,b){if(a&&G(a.wire$plugin)){var c=a.wire$plugin(Q,P.promise,b);c&&(gb(c.resolvers,k),gb(c.factories,m),gb(c.facets,x),y.push(c),fb(c.proxies))}}function fb(a){if(!a)return;var b,c,d=0;b=[];while(c=a[d++])r(A,c)<0&&b.push(c);f.proxies=A=b.concat(A)}function gb(a,b){for(var c in a){if(b.hasOwnProperty(c))throw new Error("Two plugins for same type in scope: "+c);b[c]=a[c]}}function hb(a,b){return a.length?d.map(a,function(a){return cb(a,b+"[]")}):[]}function ib(a,b){return d(jb(a),function(c){var d=n();return a.id||(a.id=b),c(d.resolver,a,j),kb(d,a)},function(){return B(a,f,b)})}function jb(a){function b(){var b,c;for(b in m)if(a.hasOwnProperty(b)){c=m[b];break}return c}return b()||d(K,function(){return b()||v(a)})}function kb(a,b){return d(a,function(a){var c=lb(a,b);return h.push(c),d.reduce(s,function(a,b){return mb(b,c)},c)})}function lb(a,b){var c,d,e,f;f=0,e=b.id;while((c=A[f++])&&!(d=c(a,b)));return d.target=a,d.spec=b,d.id=e,d.path=ab(e),d}function mb(a,b){var c,d,e,f;c=[],f=b.spec;for(e in x)d=f[e],d&&ob(c,x[e],a,b,d);var g=n();return p(c,function(){nb(g,a,b)},u(g)),g}function nb(a,b,c){var d=[];for(var e=0;e<y.length;e++)ob(d,y[e],b,c);return o(p(d),a,c.target)}function ob(a,b,c,d,e){var f,g;b&&b[c]&&(g=n(),a.push(g),f=l(d),f.options=e,b[c](g.resolver,f,j))}function pb(a,b){o(db(b.module,b),a)}function qb(a,b){function j(b){function e(c){try{var d=L(b,c,h);a.resolve(d)}catch(e){a.reject(e)}}try{G(b)?g?(g=q(g)?g:[g],d(hb(g,i),e,c)):e([]):a.resolve(b)}catch(f){c(f)}}var c,e,f,g,h,i;c=u(a),i=b.id,e=b.create,F(e)?(f=e.module,g=e.args,h=e.isConstructor):f=e,d(db(f,b),j,c)}function rb(a,b){function i(a){var b=a?[].concat(e,a):e;return _(b)}var c,e,f,g,h;c=b.wire,E(c)?e=c:(e=c.spec,h=c.waitParent,g=c.defer,f=c.get);if(g&&f){a.reject("you can't use defer and get at the same time");return}if(g)a.resolve(i);else if(f)d(w(e),function(a){return d(cb(a,f),function(a){return tb(f,{},a)})}).then(a.resolve,a.reject);else if(h){var j=d(Q,function(){return i()});a.resolve(new N(j))}else o(i(),a)}function sb(a,c){var d=a.$ref;return tb(d,a,c==d?b.objects:i)}function tb(a,b,c){var e,f,g,h;return c=c||i,a in c?e=c[a]:(f=n(),g=a.indexOf("!"),g>0?(h=a.substring(0,g),a=a.substring(g+1),d(K,function(){var c=k[h];c?c(f.resolver,a,b||{},j):f.reject("No resolver found for ref: "+a)})):f.reject("Cannot resolve ref: "+a),e=f.promise),e}function ub(a){a.resolve(J)}function vb(){return d(M,R,R)}var f,g,h,i,j,k,m,x,y,A,C,I,J,K,M,P,Q,R;return b=b||{},S(b),U(),eb(e),Q=V(a,M),W(a),X(),R=function(){return R=function(){},Y()},M.promise}function C(a,b){for(var c in b)if(b.hasOwnProperty(c)&&!(c in m)){if(a.hasOwnProperty(c))throw new Error("Duplicate component name in sibling specs: "+c);a[c]=b[c]}return a}function D(a){return a&&a.hasOwnProperty("$ref")}function E(a){return typeof a=="string"}function F(a){return a&&f.call(a)=="[object Object]"}function G(a){return typeof a=="function"}function H(a){return a?[].concat(a):[]}function I(){}function J(a){var b;return I.prototype=a,b=new I,I.prototype=t,b}function K(a,b){return a.apply(this,b)}function L(a,b,c){var d;return c||M(a)?(K.prototype=a.prototype,K.prototype.constructor=a,d=new K(a,b),K.prototype=t):d=a.apply(null,b),d}function M(a){var b=!1,c;for(c in a.prototype)if(c!==t){b=!0;break}return b}function N(a){this.value=a}function O(a){return a instanceof N?a.value:a}"use strict";var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;x.version="0.8.2",j=a.wire||{},s=["create","configure","initialize","connect","ready"],m={},f=Object.prototype.toString,g=Array.prototype,i=g.slice,h=g.indexOf,l=Object.create||J,q=Array.isArray||function(a){return f.call(a)=="[object Array]"},r=h?function(a,b){return h.call(a,b)}:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},m={},n=d.defer,o=d.chain,p=d.all;var w=b.amd?function(a){var b=n();return c([a],b.resolve),b.promise}:c;return x.load=y,x.pluginBuilder="./build/amd/builder",x})})(this,typeof define=="function"?define:typeof module!="undefined"?function(a,b){module.exports=b.apply(this,[require].concat(a.slice(1).map(function(a){return require(a)})))}:function(a,b){this.wire=b(function(a,b){b(a)},this.when,this.wire_base)});