(function(){define(["underscore","lib/coupler"],function(n,t){return{wire$plugin:function(e,r,o){var u,f,i,c,s;s=[];i=function(n,e,r,o){if(typeof n[e]!=="function"){throw"target event "+e+" must be a function"}if(typeof r[o]!=="function"){throw"target method "+o+" must be a function"}t.connect(n,e,r,o);return s.push([n,e,r,o])};u=function(t,e,r,o){var u,f,c;if(typeof t[e]==="function"){c=[];for(f in r){u=function(u){return o.resolveRef(u).then(function(o){var f,c,s,a,h;c=n.isArray(r[u])?r[u]:[r[u]];h=[];for(s=0,a=c.length;s<a;s++){f=c[s];h.push(i(o,f,t,e))}return h})};c.push(u(f))}return c}else{return o.resolveRef(e).then(function(n){var e;e=[];for(f in r){e.push(i(t,r[f],n,f))}return e})}};f=function(n,t,e){var r,o;o=[];for(r in e){o.push(u(t,r,e[r],n))}return o};c=function(){var n,e,r,o,u,f,i;for(u=0,f=s.length;u<f;u++){i=s[u],e=i[0],n=i[1],o=i[2],r=i[3];t.disconnect(e,n,o,r)}};r.then(c,function(n){return log("ERROR in coupler.destroyed.then",n)});return{facets:{connect:{ready:function(n,t,e){f(e,t.target,t.options);return n.resolve()}}}}}}})}).call(this);