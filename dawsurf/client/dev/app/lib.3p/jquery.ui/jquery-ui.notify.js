(function(e){e.widget("ech.notify",{options:{speed:500,expires:5e3,stack:"below",custom:false,queue:false},_create:function(){var t=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message ui-notify-message-style").each(function(i){var s=this.id||i;t.keys.push(s);t.templates[s]=e(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty().show()},create:function(t,i,s){if(typeof t==="object"){s=i;i=t;t=null}var n=this.templates[t||this.keys[0]];if(s&&s.custom){n=e(n).removeClass("ui-notify-message-style").wrap("<div></div>").parent().html()}this.openNotifications=this.openNotifications||0;return new e.ech.notify.instance(this)._create(i,e.extend({},this.options,s),n)}});e.extend(e.ech.notify,{instance:function(e){this.__super=e;this.isOpen=false}});e.extend(e.ech.notify.instance.prototype,{_create:function(t,i,s){this.options=i;var n=this,o=s.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(e,i){return i in t?t[i]:""}),r=this.element=e(o),p=r.find(".ui-notify-close");if(typeof this.options.click==="function"){r.addClass("ui-notify-click").bind("click",function(e){n._trigger("click",e,n)})}if(p.length){p.bind("click",function(){n.close();return false})}this.__super.element.queue("notify",function(){n.open();if(typeof i.expires==="number"&&i.expires>0){setTimeout(e.proxy(n.close,n),i.expires)}});if(!this.options.queue||this.__super.openNotifications<=this.options.queue-1){this.__super.element.dequeue("notify")}return this},close:function(){var t=this.options.speed;this.element.fadeTo(t,0).slideUp(t,e.proxy(function(){this._trigger("close");this.isOpen=false;this.element.remove();this.__super.openNotifications-=1;this.__super.element.dequeue("notify")},this));return this},open:function(){if(this.isOpen||this._trigger("beforeopen")===false){return this}var e=this;this.__super.openNotifications+=1;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.__super.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){e._trigger("open");e.isOpen=true});return this},widget:function(){return this.element},_trigger:function(e,t,i){return this.__super._trigger.call(this,e,t,i)}})})(jQuery);