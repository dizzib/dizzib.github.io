(function(n){n(["when"],function(n){"use strict";var e,r;e={init:c(["create","configure","initialize"]),startup:c(["connect","ready"]),shutdown:c(["destroy"])};function t(n){this._config=n}for(r in e){t.prototype[r]=i(r)}return t;function i(r){var t=e[r];return function(e){var r=this;return n.reduce(t,function(n,t){return u(t,e,r._config)},e)}}function u(e,r,t){var i,u,c,a,s;i=[];a=r.spec;s=t.facets;for(c in s){u=a[c];if(u){f(i,s[c],e,r,u,t.pluginApi)}}var p=n.defer();n.all(i,function(){return n.chain(o(e,r,t),p,r)},function(n){p.reject(n)});return p}function o(e,r,t){var i,u;i=t.listeners;u=[];for(var o=0;o<i.length;o++){f(u,i[o],e,r,{},t.pluginApi)}return n.all(u)}function f(e,r,t,i,u,o){var f,c;if(r&&r[t]){c=n.defer();e.push(c);f=Object.create(i);f.options=u;r[t](c.resolver,f,o)}}function c(n){return n.reduce(a,[])}function a(n,e){n.push(e+":before");n.push(e);n.push(e+":after");return n}})})(typeof define=="function"?define:function(n,e){module.exports=e.apply(this,n.map(function(n){return require(n)}))});