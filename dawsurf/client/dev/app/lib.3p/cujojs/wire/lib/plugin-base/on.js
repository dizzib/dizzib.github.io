(function(n){n(["when","when/apply","../functional","../connection"],function(n,t,e,r){"use strict";var o,i,u,a;o={selector:1,transform:1,preventDefault:1,stopPropagation:1};i=/#|\.|-|[^,]\s[^,]/;u=/\s*,\s*/;return function f(t){var i;i=t.on;return{wire$plugin:function u(t,u,c){var s=[];if(!c){c={}}function p(n,t,e){var r,o,i;r=g(t);o=c.preventDefault;i=c.stopPropagation;s=s.concat(a(r,n,e,o,i))}function l(t,i,u,f){var l,v,m,h,y,d,w,D,P;l=i.target;P=[];h=u.selector;D=u.transform;y=u.preventDefault||c.preventDefault;d=u.stopPropagation||c.stopPropagation;function E(r,o,u){return n(u,function(n){var u=e.compose([n,o]).bind(i.target);s=s.concat(a(r,t,function(){return i.invoke(u,arguments)},y,d))})}for(v in u){if(!(v in o)){if(D){m=g(v,h);w=u[v];P.push(E(m,l[w],f(D)))}else{P.push(r.parseIncoming(t,v,i,c,u[v],f,p))}}}return n.all(P)}function v(t,e,o,i){return n(i.resolveRef(e),function(n){return l(n,t,o,i)},function(){return r.parseOutgoing(t,e,o,i,p)})}function m(t,e){var r,o;o=e.options;r=[];for(var i in o){r.push(v(e,i,o[i],t))}return n.all(r)}u.then(function h(){for(var n=s.length-1;n>=0;n--){s[n]()}});return{facets:{on:{connect:function(t,e,r){n.chain(m(r,e),t)}}},resolvers:{on:function(n,t){n.resolve(t?f(t):i)}}}}};function a(n,t,e,r,o){var u,a;u=[];for(var f=0,c=n.length;f<c;f++){a=v(e,r,o);u.push(i(t,n[f],a,n.selector))}return u}function f(n){var t;t=g(n,"");return function(){var n,e,r,o;n=Array.prototype.slice.call(arguments,0,3);e=n.length>1?n.shift():document;r=n[0];o=[];t.forEach(function(n){o.push(i(e,n,r,t.selector))});return function(){o.forEach(function(n){n()})}}}};function c(n){var t,e,r,o;t=n.selectorTarget||n.target||n.srcElement;if(t){e=t.tagName;r=t.type&&t.type.toLowerCase();o="click"==n.type&&"A"==e||"submit"==r&&t.form||"submit"==n.type&&"FORM"==e;if(o){s(n)}}}function s(n){n.preventDefault()}function p(n){n.stopPropagation()}function l(){}function v(n,t,e){var r,o;r=t==a||t=="auto"?c:t?s:l;o=e?p:l;return function(t){r(t);o(t);return n(t)}}function g(n,t){var e,r,o;e=n.split(":",2);r=e[0];o=e[1]||t;if(i.test(r)){throw new Error("on! resolver: malformed event-selector string (event missing?)")}r=r.split(u);if(o){r.selector=o}return r}})})(typeof define=="function"&&define.amd?define:function(n,t){module.exports=t.apply(this,n.map(require))});