(function(t){t.fn.antiscroll=function(i){return this.each(function(){if(t(this).data("antiscroll")){t(this).data("antiscroll").destroy()}t(this).data("antiscroll",new t.Antiscroll(this,i))})};t.Antiscroll=i;function i(i,e){this.el=t(i);this.options=e||{};this.x=false!==this.options.x;this.y=false!==this.options.y;this.padding=undefined==this.options.padding?2:this.options.padding;this.inner=this.el.find(".antiscroll-inner");this.refresh()}i.prototype.refresh=function(){var i=this.el.width(),s=this.el.height(),n,o;this.inner.css({"min-width":i+t.scrollbarWidth()+"px","min-height":s+t.scrollbarWidth()+"px"});n=this.inner.get(0).scrollWidth>this.inner.get(0).clientWidth;o=this.inner.get(0).scrollHeight>this.inner.get(0).clientHeight;if(!this.horizontal&&n&&this.x){this.horizontal=new e.Horizontal(this)}else if(this.horizontal&&!n){this.horizontal.destroy();this.horizontal=null}if(!this.vertical&&o&&this.y){this.vertical=new e.Vertical(this)}else if(this.vertical&&!o){this.vertical.destroy();this.vertical=null}};i.prototype.destroy=function(){if(this.horizontal){this.horizontal.destroy();this.horizontal=null}if(this.vertical){this.vertical.destroy();this.vertical=null}return this};i.prototype.rebuild=function(){this.destroy();this.inner.attr("style","");i.call(this,this.el,this.options);return this};function e(i){this.pane=i;this.pane.el.append(this.el);this.innerEl=this.pane.inner.get(0);this.dragging=false;this.enter=false;this.shown=false;this.pane.el.mouseenter(t.proxy(this,"mouseenter"));this.pane.el.mouseleave(t.proxy(this,"mouseleave"));this.el.mousedown(t.proxy(this,"mousedown"));this.pane.inner.scroll(t.proxy(this,"scroll"));this.pane.inner.bind("mousewheel",t.proxy(this,"mousewheel"));var e=this.pane.options.initialDisplay;if(e!==false){this.show();this.hiding=setTimeout(t.proxy(this,"hide"),parseInt(e,10)||3e3)}}e.prototype.destroy=function(){this.el.remove();return this};e.prototype.mouseenter=function(){this.enter=true;this.show()};e.prototype.mouseleave=function(){this.enter=false;if(!this.dragging){this.hide()}};e.prototype.scroll=function(){if(!this.shown){this.show();if(!this.enter&&!this.dragging){this.hiding=setTimeout(t.proxy(this,"hide"),1500)}}this.update()};e.prototype.mousedown=function(i){i.preventDefault();this.dragging=true;this.startPageY=i.pageY-parseInt(this.el.css("top"),10);this.startPageX=i.pageX-parseInt(this.el.css("left"),10);document.onselectstart=function(){return false};var e=this.pane,s=t.proxy(this,"mousemove"),n=this;t(document).mousemove(s).mouseup(function(){n.dragging=false;document.onselectstart=null;t(document).unbind("mousemove",s);if(!n.enter){n.hide()}})};e.prototype.show=function(t){if(!this.shown){this.update();this.el.addClass("antiscroll-scrollbar-shown");if(this.hiding){clearTimeout(this.hiding);this.hiding=null}this.shown=true}};e.prototype.hide=function(){var t=this.pane.options.autoHide;if(t!==false&&this.shown){this.el.removeClass("antiscroll-scrollbar-shown");this.shown=false}};e.Horizontal=function(i){this.el=t('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">');e.call(this,i)};s(e.Horizontal,e);e.Horizontal.prototype.update=function(){var t=this.pane.el.width(),i=t-this.pane.padding*2,e=this.pane.inner.get(0);this.el.css("width",i*t/e.scrollWidth).css("left",i*e.scrollLeft/e.scrollWidth)};e.Horizontal.prototype.mousemove=function(t){var i=this.pane.el.width()-this.pane.padding*2,e=t.pageX-this.startPageX,s=this.el.width(),n=this.pane.inner.get(0);var o=Math.min(Math.max(e,0),i-s);n.scrollLeft=(n.scrollWidth-this.pane.el.width())*o/(i-s)};e.Horizontal.prototype.mousewheel=function(t,i,e,s){if(e<0&&0==this.pane.inner.get(0).scrollLeft||e>0&&this.innerEl.scrollLeft+Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth){t.preventDefault();return false}};e.Vertical=function(i){this.el=t('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">');e.call(this,i)};s(e.Vertical,e);e.Vertical.prototype.update=function(){var t=this.pane.el.height(),i=t-this.pane.padding*2,e=this.innerEl;this.el.css("height",i*t/e.scrollHeight).css("top",i*e.scrollTop/e.scrollHeight)};e.Vertical.prototype.mousemove=function(t){var i=this.pane.el.height(),e=i-this.pane.padding*2,s=t.pageY-this.startPageY,n=this.el.height(),o=this.innerEl;var h=Math.min(Math.max(s,0),e-n);o.scrollTop=(o.scrollHeight-i)*h/(e-n)};e.Vertical.prototype.mousewheel=function(t,i,e,s){if(s>0&&0==this.innerEl.scrollTop||s<0&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight){t.preventDefault();return false}};function s(t,i){function e(){}e.prototype=i.prototype;t.prototype=new e}var n;function o(){if(n===undefined){var i=t('<div style="width:50px;height:50px;overflow:hidden;'+'position:absolute;top:-200px;left:-200px;"><div style="height:100px;">'+"</div>");t("body").append(i);var e=t("div",i).innerWidth();i.css("overflow-y","scroll");var s=t("div",i).innerWidth();t(i).remove();n=e-s}return n}})(jQuery);