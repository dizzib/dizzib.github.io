(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery","underscore","lib/guardian","text!./device.html","css!./device"],function(e,i,n,r){var o;return new(o=function(){function o(){this._reposition=t(this._reposition,this);this._get_device_head=t(this._get_device_head,this);this._get_device_body=t(this._get_device_body,this);this._get_device=t(this._get_device,this);this._create=t(this._create,this);this.rename=t(this.rename,this);this.remove=t(this.remove,this);this.ready=t(this.ready,this);this.move=t(this.move,this);this.insert=t(this.insert,this);this.clear=t(this.clear,this);this.bypass=t(this.bypass,this);this.add_box=t(this.add_box,this);this.add=t(this.add,this);this.init=t(this.init,this)}o.prototype._INIT_MSG=" loading...";o.prototype.init=function(t){t.$desk.on("safe-tap",".device h2",{on_toggle:this.on_toggle},function(t){var i;(i=e(this)).indicate().parents(".device").toggleClass("hidden");t.data.on_toggle({$target:i});return t.handled=true});return this._render=i.template(r)};o.prototype.on_add=function(){};o.prototype.on_added=function(){};o.prototype.on_remove=function(){};o.prototype.on_toggle=function(){};o.prototype.add=function(t){this.on_add(i.extend(t,{$device:this._create(t)}));return this.on_added(t)};o.prototype.add_box=function(t){return this._get_device_body(t).append(t.$box)};o.prototype.bypass=function(t){return this._get_device(t).toggleClass("bypass blinking",t.bypass)};o.prototype.clear=function(t){return this._get_device_body(t).empty()};o.prototype.get_by_uid=function(t){return e("#"+t+".device")};o.prototype.insert=function(t){var e;this._reposition(t,e=this._create(t));return this.on_added({$device:e})};o.prototype.move=function(t){return this._reposition(t,this._get_device(t))};o.prototype.ready=function(t){var e;e=t.find("h2");return e.text(e.text().replace(this._INIT_MSG,""))};o.prototype.remove=function(t){var e,i=this;return(e=this._get_device(t)).fadeOut(function(){i.on_remove({$device:e});return e.remove()})};o.prototype.rename=function(t){return this._get_device_head(t).html(t.name)};o.prototype._create=function(t){return e(this._render(i.extend(t,{init_msg:this._INIT_MSG})))};o.prototype._get_device=function(t){return this.get_by_uid(t.uid)};o.prototype._get_device_body=function(t){return this._get_device(t).find(".body")};o.prototype._get_device_head=function(t){return this._get_device(t).find("h2")};o.prototype._get_target=function(t){return e("#"+n.assert(function(){return t.target_uid})+".device")};o.prototype._reposition=function(t,e){var i;i=this._get_target(t);if(t.target_placement==="Before"){return e.insertBefore(i)}else{return e.insertAfter(i)}};return o}())})}).call(this);