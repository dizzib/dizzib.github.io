(function(){var t=function(t,r){return function(){return t.apply(r,arguments)}};define(["./balancer","./builder","./defragger","./laner","./stitcher"],function(r,i,e,n,u){var o;return new(o=function(){function o(){this._append_wild_group=t(this._append_wild_group,this);this._extract_oversized_wild_group=t(this._extract_oversized_wild_group,this);this.build=t(this.build,this)}o.prototype._WILD_GROUP_ID=1;o.prototype.build=function(t,r,i){var e;this._extract_oversized_wild_group(t,r,i,e=[]);return e.concat(this._build(t,r,i))};o.prototype._build=function(t,_,o){var p,a,c,s;a=n.create(_,o);i.build(a,t,_);for(c=0,s=a.length;c<s;c++){p=a[c];p.matrix=e.defrag(p.matrix)}return u.stitch(r.balance(a))};o.prototype._extract_oversized_wild_group=function(t,r,i,e){var n,u,o;if((n=_.indexOf(t,this._WILD_GROUP_ID))===-1){return false}if(this._check_is_oversized_wild_group(t,r,i,n)){this._append_wild_group(r[n],i,e);[].splice.apply(t,[n,n-n+1].concat(u=[])),u;return[].splice.apply(r,[n,n-n+1].concat(o=[])),o}};o.prototype._append_wild_group=function(t,r,i){var e,n,u,o,p,a=this;for(e=n=1,o=Math.ceil(t/r);1<=o?n<=o:n>=o;e=1<=o?++n:--n){i.push(_.map(function(){p=[];for(var t=1;1<=r?t<=r:t>=r;1<=r?t++:t--){p.push(t)}return p}.apply(this),function(){return a._WILD_GROUP_ID}))}return i[0][0]=-this._WILD_GROUP_ID};o.prototype._check_is_oversized_wild_group=function(t,r,i,e){var u,o,p,a,c,s;c=[r[e],n.create(r,i)],o=c[0],p=c[1];if(p.count<=1){return false}s=[p[0].x_size,_.reduce(r,function(t,r){return t+r},0)],a=s[0],u=s[1];return o/u>a/i};return o}())})}).call(this);