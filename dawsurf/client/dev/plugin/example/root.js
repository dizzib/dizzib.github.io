(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery","lib/guardian","curl","css!./root"],function(e,r,i){var n;return new(n=function(){function n(){this._reposition=t(this._reposition,this);this._kill_key_handler=t(this._kill_key_handler,this);this._init_key_handler=t(this._init_key_handler,this);this._create_param=t(this._create_param,this);this.revalue_param=t(this.revalue_param,this);this.rename_param=t(this.rename_param,this);this.rename_folder=t(this.rename_folder,this);this.remove_folder=t(this.remove_folder,this);this.move_folder=t(this.move_folder,this);this.insert_folder=t(this.insert_folder,this);this.add_param=t(this.add_param,this);this.add_folder=t(this.add_folder,this);this.kill=t(this.kill,this);this.init=t(this.init,this)}n.prototype.init=function(){var t=this;window.jQuery=window.$=e;return i(["js!plugin/lib.3p/jQuery-ZenCoding"]).then(function(){e.noConflict(true);t._$root=e(t._div_root).addClass("root").attr({id:"0"});t._init_key_handler();return t.on_init()})};n.prototype.kill=function(){this._kill_key_handler();return this._$root.removeAttr("id").removeClass("root").empty()};n.prototype.on_init=function(){};n.prototype.on_exit=function(){};n.prototype.add_folder=function(t){return this._get_target(t).append(this._create_folder(t))};n.prototype.add_param=function(t){return this._get_target(t).append(this._create_param(t).html(this._get_param_html(t)))};n.prototype.insert_folder=function(t){return this._reposition(t,this._create_folder(t))};n.prototype.move_folder=function(t){return this._reposition(t,this._get_el(t))};n.prototype.remove_folder=function(t){return this._get_el(t).remove()};n.prototype.rename_folder=function(t){return this._get_el(t).find(">.name").html(t.name)};n.prototype.rename_param=function(t){return this._get_el(t).html(this._get_param_html(t))};n.prototype.revalue_param=function(t){return this._get_el(t).html(this._get_param_html(t))};n.prototype._create_folder=function(t){return e(e.zen("#"+t.uid+"."+t.category+">{"+t.category+" = }+span.name{"+t.name+"}"))};n.prototype._create_param=function(t){return e(e.zen("#"+t.uid+".param"))};n.prototype._get_el=function(t){return e("#"+r.assert(function(){return t.uid}))};n.prototype._get_target=function(t){return e("#"+t.target_uid)};n.prototype._get_param_html=function(t){return e.zen("p{param:"+t.name+" = "+t.value_text+"}")};n.prototype._init_key_handler=function(){var t=this;return e(document).on("keydown",function(r){if(r.which===e.ui.keyCode.ESCAPE){return t.on_exit()}})};n.prototype._kill_key_handler=function(){return e(document).off("keydown")};n.prototype._reposition=function(t,e){var r;r=this._get_target(t);if(t.target_placement==="Before"){return e.insertBefore(r)}else{return e.insertAfter(r)}};return n}())})}).call(this);