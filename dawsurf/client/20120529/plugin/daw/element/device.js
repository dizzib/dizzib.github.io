(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","plugin/lib/datatype.extension/string","css!./device"],function(b){var c;return c=function(){function c(){this._auto_expand=a(this._auto_expand,this),this._create=a(this._create,this),this.ready=a(this.ready,this),this.rename=a(this.rename,this),this.remove=a(this.remove,this),this.move=a(this.move,this),this.insert=a(this.insert,this),this.clear=a(this.clear,this),this.add=a(this.add,this),this.init=a(this.init,this)}return c.prototype._INIT_MSG=" loading...",c.prototype._AUTO_EXPAND_WILD_GROUP_THRESHOLD=8,c.prototype._AUTO_EXPAND_TAME_BOX_THRESHOLD=4,c.prototype.init=function(a){return assert(function(){return a.$desk}).on("safe-tap",".device h2",{on_toggle:this.on_toggle},function(a){var c;return(c=b(this)).indicate().parents(".device").toggleClass("hidden"),a.data.on_toggle({$target:c}),!1})},c.prototype.on_shake=function(){},c.prototype.on_toggle=function(){},c.prototype.add=function(a){return this._create(a).appendTo(assert(function(){return b("#"+a.target_uid+".track > .body")})),this.on_shake(a)},c.prototype.clear=function(a){return b("#"+a.uid+".device > .body").empty()},c.prototype.insert=function(a){var c,d;return c=this._create(a),d=assert(function(){return b("#"+a.target_uid+".device")}),a.target_placement==="Before"?c.insertBefore(d):c.insertAfter(d),this.on_shake(a)},c.prototype.move=function(a){var c,d;return c=assert(function(){return b("#"+a.uid+".device")}),d=assert(function(){return b("#"+a.target_uid+".device")}),a.target_placement==="Before"?c.insertBefore(d):c.insertAfter(d)},c.prototype.remove=function(c){var d;return d=assert(function(){return b("#"+c.uid+".device")}),d.fadeOut(a(function(){return this.on_shake(c),d.remove()},this))},c.prototype.rename=function(a){return b("#"+a.uid+".device h2").html(a.name.fracture())},c.prototype.ready=function(a){var c;return c=assert(function(){return b("h2",a.$target)}),c.text(c.text().replace(this._INIT_MSG,"")),this._auto_expand(a)},c.prototype._create=function(a){var c,d,e,f;return d=b("<div/>").attr({id:a.uid,"class":"device"}),f=b("<div/>").attr({"class":"head"}),e=b("<h2/>").html(""+a.name.fracture()+this._INIT_MSG).appendTo(f),c=b("<div/>").attr({"class":"body"}),d.append(f.after(c))},c.prototype._auto_expand=function(a){var c,d,e;c=b(".box.wild",a.$target),(e=b(".group",c)).length<=this._AUTO_EXPAND_WILD_GROUP_THRESHOLD&&(e.removeClass("collapsed"),b(".param",c).removeClass("hidden"));if((d=b(".box.tame",a.$target)).length<=this._AUTO_EXPAND_TAME_BOX_THRESHOLD)return d.removeClass("hidden")},c}(),new c})}).call(this);