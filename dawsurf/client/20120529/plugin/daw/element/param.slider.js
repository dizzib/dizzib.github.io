(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","underscore","plugin/strategy.pan/viewport","strategy/touch","lib/guardian","css!./param.slider.css"],function(b,c,d,e){var f;return f=function(){function f(){this._disable_rail=a(this._disable_rail,this),this._enable_rail=a(this._enable_rail,this),this._get_initial_pos=a(this._get_initial_pos,this),this._on_mousemove=a(this._on_mousemove,this),this.stop_input=a(this.stop_input,this),this.start_input=a(this.start_input,this),this.kill=a(this.kill,this),this.init=a(this.init,this)}return f.prototype._THROTTLE_FREQ_HZ=20,f.prototype.init=function(){return this._$rail=b("<div/>").attr({"class":"rail"}).appendTo(assert(a(function(){return this._div_root},this))),this._$puck=b("<div/>").attr({"class":"puck"}).appendTo(this._$rail),this._rail_width=this._$rail.width(),this._puck_width_semi=this._$puck.width()/2},f.prototype.kill=function(){return this._$rail.remove()},f.prototype.on_value_change=function(){},f.prototype.on_input_stop=function(){},f.prototype.start_input=function(c,f){var g,h,i,j,k,l;return this._uid=c.uid,this._$param=assert(function(){return b("#"+c.uid+".param")}),g=assert(a(function(){return b(".sensor",this._$param)},this)),k=this._$param.attr("value"),this._$param.attr("value_user",k),l=this._get_initial_pos(k,f.pageX),h=l[0],j=l[1],i=this._$rail.height()+2*parseInt(this._$rail.css("border-top-width"),10),this._$puck.css("left",h),this._$rail.css("left",j).css("top",d.get_css_bottom(g)-i),f.is_tap?this._$rail.on(e.event_name_start,a(function(a){return this._on_mousemove(e.get_raw_event(a)),this._enable_rail(),!1},this)):this._enable_rail(),this._$rail.show()},f.prototype.stop_input=function(a){return this._disable_rail(),this._$rail.off(e.event_name_start),this._$rail.off(e.event_name_end),this._$puck.off(e.event_name_end),this.on_input_stop(a),this._$rail.hide()},f.prototype._on_mousemove=function(b){var c,f,g;if(this._$rail.is(":hidden"))return;c=Math.min(this._rail_width,Math.max(0,b.pageX-d.get_pos_left(this._$rail))),this._$puck.css("left",c-this._puck_width_semi),g=parseInt(this._$param.attr("value_user")),f=100*c/this._rail_width;if(f!==g)return this._$param.attr("value_user",f),this.on_value_change({uid:this._uid,value:f}),this._$rail.on(e.event_name_end,a(function(a){return this.stop_input(e.get_raw_event(a))},this)),this._$puck.on(e.event_name_end,a(function(a){return this.stop_input(e.get_raw_event(a))},this))},f.prototype._get_initial_pos=function(a,b){var c,e,f;return e=this._rail_width*a/100,c=e-this._puck_width_semi,b!=null?f=b-e:f=d.get_css_left(this._$param)-e,[c,f]},f.prototype._enable_rail=function(){return assert(a(function(){return this._$rail},this)).on(e.event_name_move,c.throttle(a(function(a){return this._on_mousemove(e.get_raw_event(a))},this),1e3/this._THROTTLE_FREQ_HZ))},f.prototype._disable_rail=function(){return assert(a(function(){return this._$rail},this)).off(e.event_name_move)},f}(),new f})}).call(this);