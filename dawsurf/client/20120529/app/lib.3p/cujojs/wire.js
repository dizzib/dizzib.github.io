/** @license MIT License (c) copyright B Cavalier & J Hann *//**
 * wire
 * Javascript IOC Container
 *
 * wire is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 0.7.5
 */(function(a,b){b(["require","when","wire/base"],function(b,c,d){function u(a){return c.isPromise(a)?a:c(a)}function v(a){return function(b){a.reject(b)}}function w(a){var b=n();return b.reject(a),b.promise}function x(a){var c=n();return b([a],c.resolve),c.promise}function y(a){return k||(k=A(j)),c(k,function(b){return b.wire(a)})}function z(a,b,c,d){var e=c.resolve?c:{resolve:c,reject:function(a){throw a}};o(y(a.split(",")),e)}function A(a,b){function d(a){return c(C(a,b),function(a){return a.objects})}return c(B(q(a)?a:[a]),d)}function B(a){return c.reduce(a,function(a,b){return F(b)?c(x(b),function(b){return D(a,b)}):D(a,b)},{})}function C(a,b,e){function S(a){h={},j=l(a.objects||{}),m=l(a.resolvers||{}),y=l(a.factories||{}),z=l(a.facets||{}),m.wire=ub,y.module=pb,y.create=qb,y.wire=rb,B=I(a.listeners),D=I(a.proxies),i=[],J=[],K={},N=n(),O=n(),P=n(),g={name:e,objects:j,destroyed:P},f=l(g),f.local=h,f.resolvers=m,f.factories=y,f.facets=z,f.listeners=B,f.proxies=D,f.resolveRef=tb,f.destroy=vb,f.path=ab(e,a.path),a.destroyed&&c(a.destroyed,vb)}function T(a){L=a.wire=_,L.destroy=a.destroy=$,L.resolve=a.resolve=Z}function U(){k=function(a,b,c){return u(cb(a,ab(b,c)))},k.resolveRef=Z}function V(a,b){var c=[];for(var d in a)a.hasOwnProperty(d)&&c.push(h[d]=j[d]=n());return p(c,function(){return b.resolve(f),j},v(b))}function W(a,b){for(var c in a)bb(c,b[c],j[c])}function X(){p(J,function(a){N.resolve(a),K=J=null})}function Y(){var a,c,d,e;P.resolve(),c=[];for(e=0;a=i[e++];)d=n(),c.push(d),nb(d,"destroy",a);return p(c,function(){function a(a){for(var b in a)delete a[b]}a(h),a(j),a(f);var c,d;for(d=0;c=i[d++];)c.destroy();h=j=f=i=D=b=m=y=z=L=t,B=t}),P}function Z(a){return c(tb(a))}function $(){return vb()}function _(a){return A(a,g)}function ab(a,b){var c=b||f.path;return c&&a?c+"."+a:a}function bb(a,b,d){var e=cb(b,a);return c(e,function(b){j[a]=h[a]=b,d.resolve(b)},v(d))}function cb(a,b){var c;return E(a)?c=sb(a,b):q(a)?c=hb(a,b):G(a)?c=ib(a,b):c=a,c}function db(a,b){var d,e;if(F(a)){var f=K[a];f||(J.push(a),f=K[a]={id:a,deferred:n()},K[a]=f,e=c(x(a),function(a){eb(a,b),o(N,f.deferred,a)}),J.push(e)),d=f.deferred}else d=a,eb(d);return d}function eb(a,b){if(a&&H(a.wire$plugin)){var c=a.wire$plugin(Q,P.promise,b);c&&(gb(c.resolvers,m),gb(c.factories,y),gb(c.facets,z),B.push(c),fb(c.proxies))}}function fb(a){if(!a)return;var b,c,d=0;b=[];while(c=a[d++])r(D,c)<0&&b.push(c);f.proxies=D=b.concat(D)}function gb(a,b){for(var c in a){if(b.hasOwnProperty(c))throw new Error("Two plugins for same type in scope: "+c);b[c]=a[c]}}function hb(a,b){return a.length?c.map(a,function(a){return cb(a,b+"[]")}):[]}function ib(a,b){return c(jb(a),function(c){var d=n();return a.id||(a.id=b),c(d.resolver,a,k),kb(d,a)},function(){return c(C(a,f,b),function(a){return a.local},w)})}function jb(a){function b(){var b,c;for(b in y)if(a.hasOwnProperty(b)){c=y[b];break}return c}return b()||c(N,function(){return b()||w(a)})}function kb(a,b){return c(a,function(a){var d=lb(a,b);return i.push(d),c.reduce(s,function(a,b){return mb(b,d)},d)},w)}function lb(a,b){var c,d,e,f;f=0,e=b.id;while((c=D[f++])&&!(d=c(a,b)));return d.target=a,d.spec=b,d.id=e,d.path=ab(e),d}function mb(a,b){var c,d,e,f;c=[],f=b.spec;for(e in z)d=f[e],d&&ob(c,z[e],a,b,d);var g=n();return p(c,function(){nb(g,a,b)},v(g)),g}function nb(a,b,c){var d=[];for(var e=0;e<B.length;e++)ob(d,B[e],b,c);return o(p(d),a,c.target)}function ob(a,b,c,d,e){var f,g;b&&b[c]&&(g=n(),a.push(g),f=l(d),f.options=e,b[c](g.resolver,f,k))}function pb(a,b){o(db(b.module,b),a)}function qb(a,b){function j(b){function e(c){try{var d=M(b,c,h);a.resolve(d)}catch(e){a.reject(e)}}try{H(b)?g?(g=q(g)?g:[g],c(hb(g,i),e,d)):e([]):a.resolve(b)}catch(f){d(f)}}var d,e,f,g,h,i;d=v(a),i=b.id,e=b.create,G(e)?(f=e.module,g=e.args,h=e.isConstructor):f=e,c(db(f,b),j,d)}function rb(a,b){function f(a){var b=a?[].concat(d,a):d;return _(b)}var c,d,e;c=b.wire,F(c)?d=c:(d=c.spec,e=c.defer);if(e)a.resolve(f);else{var g=f();a.resolve(g)}}function sb(a,b){var c=a.$ref;return tb(c,a,b==c)}function tb(a,d,e){var f,g;g=e?b.objects:j;if(a in g)f=g[a];else{var h;f=n(),h=a.indexOf("!");if(h>0){var i=a.substring(0,h);a=a.substring(h+1),c(N,function(){var b=m[i];b?b(f,a,d,k):f.reject("No resolver found for ref: "+a)})}else f.reject("Cannot resolve ref: "+a)}return f}function ub(a){a.resolve(L)}function vb(){return c(O,R,R)}var f,g,h,i,j,k,m,y,z,B,D,J,K,L,N,O,P,Q,R;return b=b||{},S(b),U(),eb(d),Q=V(a,O),T(j),W(h,a),X(),R=function(){return R=function(){},Y()},O.promise}function D(a,b){for(var c in b)if(b.hasOwnProperty(c)&&!(c in m)){if(a.hasOwnProperty(c))throw new Error("Duplicate component name in sibling specs: "+c);a[c]=b[c]}return a}function E(a){return a&&a.$ref}function F(a){return typeof a=="string"}function G(a){return a&&f.call(a)=="[object Object]"}function H(a){return typeof a=="function"}function I(a){return a?[].concat(a):[]}function J(){}function K(a){return J.prototype=a,new J}function L(a,b){return a.apply(this,b)}function M(a,b,c){return c||N(a)?(L.prototype=a.prototype,L.prototype.constructor=a,new L(a,b)):a.apply(null,b)}function N(a){var b=!1,c;for(c in a.prototype)if(c!==t){b=!0;break}return b}"use strict";var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return y.version=e="0.7.5",j=a.wire||{},s=["create","configure","initialize","ready"],m={},f=Object.prototype.toString,g=Array.prototype,i=g.slice,h=g.indexOf,l=Object.create||K,q=Array.isArray||function(a){return f.call(a)=="[object Array]"},r=h?function(a,b){return h.call(a,b)}:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},m={},n=c.defer,o=c.chain,p=c.all,y.load=z,y["plugin-builder"]="wire/cram/builder",y})})(this,typeof define=="function"?define:function(a,b){this.wire=b(function(a,b){b(a)},this.when,this.wire_base)});