(function(){define(["underscore","lib/coupler"],function(a,b){return{wire$plugin:function(c,d,e){var f,g,h,i,j;return j=[],h=function(a,c,d,e){if(typeof a[c]!="function")throw"target event "+c+" must be a function";if(typeof d[e]!="function")throw"target method "+e+" must be a function";return b.connect(a,c,d,e),j.push([a,c,d,e])},f=function(b,c,d,e){var f,g,i;if(typeof b[c]=="function"){i=[];for(g in d)f=function(f){return e.resolveRef(f).then(function(e){var g,i,j,k,l;i=a.isArray(d[f])?d[f]:[d[f]],l=[];for(j=0,k=i.length;j<k;j++)g=i[j],l.push(h(e,g,b,c));return l})},i.push(f(g));return i}return e.resolveRef(c).then(function(a){var c,e;e=[];for(c in d)e.push(h(b,d[c],a,c));return e})},g=function(a,b,c){var d,e;e=[];for(d in c)e.push(f(b,d,c[d],a));return e},i=function(){var a,c,d,e,f,g,h;for(f=0,g=j.length;f<g;f++)h=j[f],c=h[0],a=h[1],e=h[2],d=h[3],b.disconnect(c,a,e,d)},d.then(i,function(a){return console.log("ERROR in coupler.destroyed.then",a)}),{facets:{connect:{ready:function(a,b,c){return g(c,b.target,b.options),a.resolve()}}}}}}})}).call(this);